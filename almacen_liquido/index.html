<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Salida ‚Äì Almac√©n L√≠quidos</title>
  <style>
    body{
      font-family: Arial, sans-serif;
      background: linear-gradient(to right,#00416A,#E4E5E6);
      margin:0; padding:20px;
      min-height:100vh; display:flex; justify-content:center; align-items:center;
    }
    .card{
      background:white; padding:30px; border-radius:12px;
      box-shadow:0 4px 15px rgba(0,0,0,.2); max-width:400px; width:100%;
    }
    h2{ text-align:center; color:#00416A; margin-bottom:20px; }
    label{ display:block; margin-top:12px; font-weight:bold; color:#00416A; }
    input,select{
      width:100%; padding:10px; margin-top:6px;
      border:1px solid #ccc; border-radius:6px; font-size:15px;
    }
    button{
      margin-top:20px; width:100%; padding:12px;
      border:none; border-radius:6px;
      background:#00416A; color:white; font-size:16px; font-weight:bold;
      cursor:pointer;
    }
    button:hover{ background:#033b57; }
  </style>
</head>
<body>
  <div class="card">
    <h2>Salida ‚Äì Almac√©n L√≠quidos</h2>

    <label for="folio">Folio:</label>
    <input type="text" id="folio" readonly>

    <label for="fecha">Fecha:</label>
    <input type="date" id="fecha" readonly>

    <label for="entrega">Entrega:</label>
    <select id="entrega">
      <option value="">Selecciona quien entrega</option>
      <option value="Arturo Rodriguez Garcia">Arturo Rodriguez Garcia</option>
      <option value="Octavio Cortes Zapata">Octavio Cortes Zapata</option>
    </select>

    <label for="recibe">Recibe:</label>
    <select id="recibe">
      <option value="">Selecciona quien recibe</option>
      <option value="YESENIA URIEGAS MENDOZA">YESENIA URIEGAS MENDOZA</option>
      <option value="PABLO NU√ëEZ PALOMINO (PABIN)">PABLO NU√ëEZ PALOMINO (PABIN)</option>
      <option value="ELOY SANCHEZ AVENDA√ëO">ELOY SANCHEZ AVENDA√ëO</option>
      <option value="JUAN MANUEL SALDA√ëA BECERRA (JUANITO)">JUAN MANUEL SALDA√ëA BECERRA (JUANITO)</option>
      <option value="LUIS ALBERTO PERALES AGUILAR (GUARDIA)">LUIS ALBERTO PERALES AGUILAR (GUARDIA)</option>
      <option value="SANDRA GUADALUPE PATI√ëO PEREZ">SANDRA GUADALUPE PATI√ëO PEREZ</option>
      <option value="MA ESTHER RODRIGUEZ SIERRA">MA ESTHER RODRIGUEZ SIERRA</option>
      <option value="GAEL HUMBERTO SANCHEZ">GAEL HUMBERTO SANCHEZ</option>
      <option value="JOSE NAPOLEON GARCIA LERMA">JOSE NAPOLEON GARCIA LERMA</option>
      <option value="JUAN CARLOS GONZALEZ TERRAZAS">JUAN CARLOS GONZALEZ TERRAZAS</option>
      <option value="VERONICA ALEJANDRO BECERRA LERMA">VERONICA ALEJANDRO BECERRA LERMA</option>
      <option value="CLAUDIA VERONICA CUELLAR RODRIGUEZ">CLAUDIA VERONICA CUELLAR RODRIGUEZ</option>
      <option value="MARTIN LEOBARDO SERNA ALEMAN">MARTIN LEOBARDO SERNA ALEMAN</option>
      <option value="HEISEL MAIRELI GUERRA DE LA CRUZ">HEISEL MAIRELI GUERRA DE LA CRUZ</option>
      <option value="ROSALVA CARRILLO SANCHEZ">ROSALVA CARRILLO SANCHEZ</option>
      <option value="LIZBETH YAQUELIN LUNA ROQUE">LIZBETH YAQUELIN LUNA ROQUE</option>
      <option value="CHRISTHOFER AARON DAVILA VALDEZ">CHRISTHOFER AARON DAVILA VALDEZ</option>
      <option value="VANIA GALILEA DUARTE VILLARREAL">VANIA GALILEA DUARTE VILLARREAL</option>
      <option value="MIGUEL ANGEL LOPEZ RDZ">MIGUEL ANGEL LOPEZ RDZ</option>
      <option value="ROLANDO RAUL GARZA">ROLANDO RAUL GARZA</option>
      <option value="FERNANDA LOERA">FERNANDA LOERA</option>
      <option value="SANTIAGO MORENO">SANTIAGO MORENO</option>
      <option value="JOSE GERARDO CABRERA TREVI√ëO">JOSE GERARDO CABRERA TREVI√ëO</option>
      <option value="RODOLFO DAVID OVIEDO INFANTE">RODOLFO DAVID OVIEDO INFANTE</option>
      <option value="LEONARDO DANIEL CUELLAR MARTINEZ">LEONARDO DANIEL CUELLAR MARTINEZ</option>
      <option value="JUAN GABRIEL PEREZ CARRILLO">JUAN GABRIEL PEREZ CARRILLO</option>
      <option value="DORA ALICIA CARDENAS TORRES">DORA ALICIA CARDENAS TORRES</option>
      <option value="JESUS GUADALUPE HERNANDEZ LUNA">JESUS GUADALUPE HERNANDEZ LUNA</option>
      <option value="JUAN ARTURO RODRIGUEZ GARCIA">JUAN ARTURO RODRIGUEZ GARCIA</option>
      <option value="OCTAVIO CORTES ZAPATA">OCTAVIO CORTES ZAPATA</option>
      <option value="JUAN MANUEL ROJAS SANCHEZ">JUAN MANUEL ROJAS SANCHEZ</option>
      <option value="ERICK SAUL RAMIREZ">ERICK SAUL RAMIREZ</option>
      <option value="JUAN MANUEL TAMEZ SERRATO">JUAN MANUEL TAMEZ SERRATO</option>
    </select>

    <label for="destino">Destino:</label>
    <select id="destino">
      <option value="">Selecciona destino</option>
      <option value="MATRIZ PISO">MATRIZ PISO</option>
      <option value="BODEGA ESPECIAS">BODEGA ESPECIAS</option>
    </select>

    <button onclick="guardarDatos()">Guardar y continuar</button>
  </div>

 <script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
  import { getFirestore, doc, setDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

  // üîπ Configuraci√≥n Firebase (ya integrada)
  const firebaseConfig = {
    apiKey: "AIzaSyCK5nb6u2CGRJ8AB1aPlRn54b97bdeAFeM",
    authDomain: "inventariopv-643f1.firebaseapp.com",
    projectId: "inventariopv-643f1",
    storageBucket: "inventariopv-643f1.firebasestorage.app",
    messagingSenderId: "96242533231",
    appId: "1:96242533231:web:aae75a18fbaf9840529e9a"
  };

  // üîπ Inicializar Firebase
  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  // === Al cargar la p√°gina ===
  window.addEventListener("DOMContentLoaded", () => {
    // Generar folio consecutivo
    let folioNum = localStorage.getItem("folioLiquidos") || 1;
    const folioTxt = "SAL-LIQ-" + String(folioNum).padStart(4, "0");
    document.getElementById("folio").value = folioTxt;

    // Fijar fecha actual
    const hoy = new Date().toISOString().split("T")[0];
    document.getElementById("fecha").value = hoy;
  });

  // === Guardar en Firestore y LocalStorage ===
  async function guardarDatos() {
    const folio = document.getElementById("folio").value;
    const fecha = document.getElementById("fecha").value;
    const entrega = document.getElementById("entrega").value;
    const recibe = document.getElementById("recibe").value;
    const destino = document.getElementById("destino").value;

    if (!folio || !fecha || !entrega || !recibe || !destino) {
      alert("‚ö†Ô∏è Por favor complete todos los campos.");
      return;
    }

    try {
      await setDoc(doc(db, "almacenes/Almacen_Liquidos/salidas_temp", folio), {
        folio, fecha, entrega, recibe, destino
      });
      console.log("‚úÖ Datos guardados en Firestore");
    } catch (e) {
      console.error("‚ùå Error al guardar:", e);
    }

    // Actualizar consecutivo
    let folioNum = parseInt(localStorage.getItem("folioLiquidos") || 1);
    localStorage.setItem("folioLiquidos", folioNum + 1);

    // Guardar en localStorage
    localStorage.setItem("salidaLiquidos", JSON.stringify({folio,fecha,entrega,recibe,destino}));

    // Ir a la pantalla 2
    window.location.href = "pantalla2.html";
  }

  window.guardarDatos = guardarDatos;
</script>
</body>
</html>
