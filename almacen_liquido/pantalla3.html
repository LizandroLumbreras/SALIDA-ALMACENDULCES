<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pantalla 3 ‚Äì Carrito (L√≠quidos)</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet"/>
  <style>
    body{font-family:'Poppins',sans-serif;background:linear-gradient(to right,#00416A,#E4E5E6);margin:0;min-height:100vh}
    .contenedor{max-width:900px;margin:auto;background:#fff;padding:20px;border-radius:12px;box-shadow:0 3px 10px rgba(0,0,0,.2);margin-top:30px}
    table{width:100%;border-collapse:collapse;margin-top:20px}
    th,td{border:1px solid #ccc;padding:8px;text-align:center}
    th{background:#00416A;color:#fff}
    input[type="number"]{width:70px;text-align:center}
    button{padding:8px 12px;border:none;border-radius:6px;cursor:pointer;font-size:15px}
    .btn-prim{background:#0c6cbd;color:#fff}
    .btn-prim:hover{background:#0a4e8c}
    .btn-sec{background:#555;color:#fff}
    .btn-sec:hover{background:#333}
    .acciones{margin-top:20px;display:flex;justify-content:space-between}
  </style>
</head>
<body>
  <div class="contenedor">
    <h2>üõí Carrito ‚Äì Almac√©n L√≠quidos</h2>

    <table>
      <thead>
        <tr>
          <th>C√≥digo</th>
          <th>Producto</th>
          <th>Unidad</th>
          <th>Cantidad</th>
          <th>Acci√≥n</th>
        </tr>
      </thead>
      <tbody id="tablaCarrito"></tbody>
    </table>

    <div class="acciones">
      <button class="btn-sec" onclick="window.location.href='pantalla2.html'">‚Üê Regresar y agregar m√°s</button>
      <button class="btn-prim" onclick="finalizar()">Finalizar y firmar ‚Üí</button>
    </div>
  </div>

  <script>
    function mostrarCarrito(){
      const carrito = JSON.parse(localStorage.getItem("carritoLiquidos")) || [];
      const tbody = document.getElementById("tablaCarrito");

      if(carrito.length === 0){
        tbody.innerHTML = "<tr><td colspan='5'>Carrito vac√≠o</td></tr>";
        return;
      }

      tbody.innerHTML = carrito.map((p, i) => `
        <tr>
          <td>${p.codigoBarra}</td>
          <td>${p.concepto}</td>
          <td>${p.unidad || ""}</td>
          <td><input type="number" min="1" value="${p.cantidad || 1}" onchange="actualizarCantidad(${i}, this.value)"></td>
          <td><button onclick="eliminar(${i})">‚ùå Eliminar</button></td>
        </tr>
      `).join("");
    }

    // üîπ Actualizar cantidad
    function actualizarCantidad(index, nuevaCantidad){
      let carrito = JSON.parse(localStorage.getItem("carritoLiquidos")) || [];
      carrito[index].cantidad = parseInt(nuevaCantidad);
      localStorage.setItem("carritoLiquidos", JSON.stringify(carrito));
      mostrarCarrito();
    }

    // üîπ Eliminar producto
    function eliminar(index){
      let carrito = JSON.parse(localStorage.getItem("carritoLiquidos")) || [];
      carrito.splice(index,1);
      localStorage.setItem("carritoLiquidos", JSON.stringify(carrito));
      mostrarCarrito();
    }

    // üîπ Guardar y pasar a pantalla 4 (firma entrega)
    function finalizar(){
      const carrito = JSON.parse(localStorage.getItem("carritoLiquidos")) || [];
      if(carrito.length === 0){
        alert("El carrito est√° vac√≠o");
        return;
      }
      window.location.href = "pantalla4.html"; 
    }

    mostrarCarrito();
  </script>
</body>
</html>
