<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Registrar salida - Dulces</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    body{font-family:Arial,sans-serif;background:linear-gradient(to right,#00416A,#E4E5E6);padding:20px;margin:0;color:white;min-height:100vh;box-sizing:border-box;position:relative}
    input[list],select,input[type="text"]{width:100%;padding:10px;margin-bottom:20px;font-size:16px;border-radius:6px;border:none;box-sizing:border-box}
    .marca-agua{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);opacity:.20;z-index:0;max-width:80%;pointer-events:none}
    .contenedor{background:rgba(255,255,255,.1);border-radius:10px;padding:30px;max-width:600px;margin:auto;position:relative;z-index:2}
    label{display:block;margin-bottom:8px}
    select,input[type="date"]{color:black}
    .boton{background-color:#d32f2f;color:white;border:none;padding:12px 20px;font-size:16px;border-radius:6px;cursor:pointer;width:100%}
    .boton:hover{background-color:#b71c1c}
    .folio{margin-bottom:20px;font-weight:bold}
    .descargar-manual{display:block;margin-top:20px;text-align:center;padding:12px 20px;background:#00416A;color:white;border-radius:6px;text-decoration:none}
  </style>
</head>
<body>
  <img src="logo_proveedora.webp" alt="Marca de agua" class="marca-agua">
  <div class="contenedor">
    <h2>Registrar salida - Dulces</h2>
    <p class="folio">ðŸ“Œ Folio prÃ³ximo: <strong id="proximoFolio">Cargando...</strong></p>

    <label for="fecha">Fecha:</label>
    <input type="date" id="fecha" readonly>

    <label for="entrega">Entrega:</label>
    <select id="entrega">
      <option value="">Selecciona quien entrega</option>
      <option value="Arturo Rodriguez Garcia">Arturo Rodriguez Garcia</option>
      <option value="Octavio Cortes Zapata">Octavio Cortes Zapata</option>
    </select>

  <label><b>Recibe:</b></label>
<div class="lista-recibe">
  <label><input type="checkbox" name="recibe" value="YESENIA URIEGAS MENDOZA"> YESENIA URIEGAS MENDOZA</label><br>
  <label><input type="checkbox" name="recibe" value="PABLO NUÃ‘EZ PALOMINO (PABIN)"> PABLO NUÃ‘EZ PALOMINO (PABIN)</label><br>
  <label><input type="checkbox" name="recibe" value="ELOY SANCHEZ AVENDAÃ‘O"> ELOY SANCHEZ AVENDAÃ‘O</label><br>
  <label><input type="checkbox" name="recibe" value="JUAN MANUEL SALDAÃ‘A BECERRA (JUANITO)"> JUAN MANUEL SALDAÃ‘A BECERRA (JUANITO)</label><br>
  <label><input type="checkbox" name="recibe" value="LUIS ALBERTO PERALES AGUILAR (GUARDIA)"> LUIS ALBERTO PERALES AGUILAR (GUARDIA)</label><br>
  <label><input type="checkbox" name="recibe" value="SANDRA GUADALUPE PATIÃ‘O PEREZ"> SANDRA GUADALUPE PATIÃ‘O PEREZ</label><br>
  <label><input type="checkbox" name="recibe" value="MA ESTHER RODRIGUEZ SIERRA"> MA ESTHER RODRIGUEZ SIERRA</label><br>
  <label><input type="checkbox" name="recibe" value="GAEL HUMBERTO SANCHEZ"> GAEL HUMBERTO SANCHEZ</label><br>
  <label><input type="checkbox" name="recibe" value="JOSE NAPOLEON GARCIA LERMA"> JOSE NAPOLEON GARCIA LERMA</label><br>
  <label><input type="checkbox" name="recibe" value="JUAN CARLOS GONZALEZ TERRAZAS"> JUAN CARLOS GONZALEZ TERRAZAS</label><br>
  <label><input type="checkbox" name="recibe" value="VERONICA ALEJANDRO BECERRA LERMA"> VERONICA ALEJANDRO BECERRA LERMA</label><br>
  <label><input type="checkbox" name="recibe" value="CLAUDIA VERONICA CUELLAR RODRIGUEZ"> CLAUDIA VERONICA CUELLAR RODRIGUEZ</label><br>
  <label><input type="checkbox" name="recibe" value="MARTIN LEOBARDO SERNA ALEMAN"> MARTIN LEOBARDO SERNA ALEMAN</label><br>
  <label><input type="checkbox" name="recibe" value="HEISEL MAIRELI GUERRA DE LA CRUZ"> HEISEL MAIRELI GUERRA DE LA CRUZ</label><br>
  <label><input type="checkbox" name="recibe" value="ROSALVA CARRILLO SANCHEZ"> ROSALVA CARRILLO SANCHEZ</label><br>
  <label><input type="checkbox" name="recibe" value="LIZBETH YAQUELIN LUNA ROQUE"> LIZBETH YAQUELIN LUNA ROQUE</label><br>
  <label><input type="checkbox" name="recibe" value="CHRISTHOFER AARON DAVILA VALDEZ"> CHRISTHOFER AARON DAVILA VALDEZ</label><br>
  <label><input type="checkbox" name="recibe" value="VANIA GALILEA DUARTE VILLARREAL"> VANIA GALILEA DUARTE VILLARREAL</label><br>
  <label><input type="checkbox" name="recibe" value="MIGUEL ANGEL LOPEZ RDZ"> MIGUEL ANGEL LOPEZ RDZ</label><br>
  <label><input type="checkbox" name="recibe" value="ROLANDO RAUL GARZA"> ROLANDO RAUL GARZA</label><br>
  <label><input type="checkbox" name="recibe" value="FERNANDA LOERA"> FERNANDA LOERA</label><br>
  <label><input type="checkbox" name="recibe" value="SANTIAGO MORENO"> SANTIAGO MORENO</label><br>
  <label><input type="checkbox" name="recibe" value="JOSE GERARDO CABRERA TREVIÃ‘O"> JOSE GERARDO CABRERA TREVIÃ‘O</label><br>
  <label><input type="checkbox" name="recibe" value="RODOLFO DAVID OVIEDO INFANTE"> RODOLFO DAVID OVIEDO INFANTE</label><br>
  <label><input type="checkbox" name="recibe" value="LEONARDO DANIEL CUELLAR MARTINEZ"> LEONARDO DANIEL CUELLAR MARTINEZ</label><br>
  <label><input type="checkbox" name="recibe" value="JUAN GABRIEL PEREZ CARRILLO"> JUAN GABRIEL PEREZ CARRILLO</label><br>
  <label><input type="checkbox" name="recibe" value="DORA ALICIA CARDENAS TORRES"> DORA ALICIA CARDENAS TORRES</label><br>
  <label><input type="checkbox" name="recibe" value="JESUS GUADALUPE HERNANDEZ LUNA"> JESUS GUADALUPE HERNANDEZ LUNA</label><br>
  <label><input type="checkbox" name="recibe" value="JUAN ARTURO RODRIGUEZ GARCIA"> JUAN ARTURO RODRIGUEZ GARCIA</label><br>
  <label><input type="checkbox" name="recibe" value="OCTAVIO CORTES ZAPATA"> OCTAVIO CORTES ZAPATA</label><br>
  <label><input type="checkbox" name="recibe" value="JUAN MANUEL ROJAS SANCHEZ"> JUAN MANUEL ROJAS SANCHEZ</label><br>
  <label><input type="checkbox" name="recibe" value="ERICK SAUL RAMIREZ"> ERICK SAUL RAMIREZ</label><br>
  <label><input type="checkbox" name="recibe" value="JUAN MANUEL TAMEZ SERRATO"> JUAN MANUEL TAMEZ SERRATO</label><br>
</div>

<label><b>Destino:</b></label>
<div class="lista-destino">
  <label><input type="checkbox" name="destino" value="MATRIZ PISO"> MATRIZ PISO</label><br>
  <label><input type="checkbox" name="destino" value="BODEGA ESPECIAS"> BODEGA ESPECIAS</label><br>
</div>

  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
  <script>
    // Firebase
    const firebaseConfig = {
      apiKey: "AIzaSyCK5nb6u2CGRJ8AB1aPlRn54b97bdeAFeM",
      authDomain: "inventariopv-643f1.firebaseapp.com",
      projectId: "inventariopv-643f1",
      storageBucket: "inventariopv-643f1.appspot.com",
      messagingSenderId: "96242533231",
      appId: "1:96242533231:web:aae75a18fbaf9840529e9a"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    async function cargarFolio() {
      const docRef = db.collection("consecutivos").doc("salidas_dulces");
      const docSnap = await docRef.get();
      let numero = 1;
      if (docSnap.exists) numero = docSnap.data().ultimo || 1;

      const folioFinal = "SALDUL - " + String(numero).padStart(4, "0");
      document.getElementById("proximoFolio").textContent = folioFinal;
      // Guarda el folio para el resumen
      localStorage.setItem("folio", folioFinal);
    }

    function ponerFechaHoy() {
      const hoy = new Date();
      const yyyy = hoy.getFullYear();
      const mm = String(hoy.getMonth() + 1).padStart(2, '0');
      const dd = String(hoy.getDate()).padStart(2, '0');
      const fechaInput = `${yyyy}-${mm}-${dd}`;
      document.getElementById("fecha").value = fechaInput;

      // Guardamos una fecha legible para el resumen
      const fechaLegible = new Date().toLocaleString("es-MX");
      localStorage.setItem("fecha", fechaLegible);
    }

    function continuar() {
      const entrega = document.getElementById("entrega").value;
      const recibe  = document.getElementById("recibe").value;
      const destino = document.getElementById("destino").value;

      if (!entrega || !recibe || !destino) {
        alert("Por favor completa todos los campos.");
        return;
      }

      localStorage.setItem("entrega", entrega);
      localStorage.setItem("recibe",  recibe);
      localStorage.setItem("destino", destino);
      // NO volver a guardar 'fecha' aquÃ­ para no pisarla con otro formato

      window.location.href = "pantalla2.html";
    }

    document.addEventListener("DOMContentLoaded", () => {
      cargarFolio();
      ponerFechaHoy();
    });
  </script>
</body>
</html>
